#:kivy 1.8.0
#:import splitext os.path.splitext

<ColorBox@Button>:
	background_normal: "atlas://data/images/defaulttheme/empty"
	background_down: "atlas://data/images/defaulttheme/empty"
	background_disabled: "atlas://data/images/defaulttheme/empty"

<IconButton@Button>:
	icon: None
    BoxLayout:
        pos: root.pos
        size: root.size
        orientation: 'horizontal'
        padding: 5
        spacing: 5
        Image:
            source: root.icon
            size_hint: (.4, 1.)
        Label:
            size_hint: (.6, 1.)
            text_size: self.size
            halign: 'left'
            valign: 'middle' 


<ReadyActionBar>:
	pos_hint: {'top':1}
	actview: actview

	ActionView:
		id: actview
		use_separator: True

		# The ActionBar doesn't work without an ActionPrevious: let's add an invisible one
		ActionPrevious:
			size_hint_x: None
			with_previous: False
			app_icon: "atlas://data/images/defaulttheme/transparent"
			width: 0

		ActionOverflow

<SettingColor>:
	rect: rect

	ColorBox:
		id: rect
		pos: root.pos

<SettingFont>:
	label: label

    Label:
    	id: label
        text: str(root.value)
        pos: root.pos
        font_size: '15sp'


<FileChooserArtView>:
    on_entry_added: stacklayout.add_widget(args[1])
    on_entries_cleared: stacklayout.clear_widgets()
    scrollview: scrollview
    scrollbar: scrollbar

    ScrollView:
        id: scrollview
        pos: [root.pos[0], root.pos[1]]
        height: root.height
        width: root.width - 40
        size_hint: None, None
        do_scroll_x: False
        scroll_y: scrollbar.value
        bar_color: [0, 0, 0, 0]

        Scatter:
            do_rotation: False
            do_scale: False
            do_translation: False
            size_hint_y: None
            height: stacklayout.height
            StackLayout:
                id: stacklayout
                width: scrollview.width
                size_hint_y: None
                height: self.minimum_height
                spacing: '10dp'
                padding: '10dp'

    Slider:
    	x: root.width
    	y: root.y
    	size_hint: None, None
    	width: 40
    	height: root.height - 20
    	id: scrollbar
    	orientation: "vertical"
    	min: 0
    	max: 1
    	value: scrollview.scroll_y

[FileThumbEntry@Widget]:
    locked: False
    path: ctx.path
    selected: self.path in ctx.controller().selection
    size_hint: None, None

    on_touch_down: self.collide_point(*args[1].pos) and ctx.controller().entry_touched(self, args[1])
    on_touch_up: self.collide_point(*args[1].pos) and ctx.controller().entry_released(self, args[1])
	size: '116dp', '116dp'

    canvas:
        Color:
            rgba: 1, 1, 1, 1 if self.selected else 0
        BorderImage:
            border: 8, 8, 8, 8
            pos: root.pos
            size: root.size
            source: 'atlas://data/images/defaulttheme/filechooser_selected'

    Image:
        size: '64dp', '64dp'
        source: ctx.controller().get_image(ctx)
        pos: root.x + dp(24), root.y + dp(40)
    Label:
        text: unicode(ctx.name, errors="replace")
        text_size: (root.width, self.height)
        halign: 'center'
        shorten: True
        size: '116dp', '16dp'
        pos: root.x, root.y + dp(16)

    Label:
        text: unicode(ctx.controller().gen_label(ctx), errors="replace")
        font_size: '11sp'
        color: .8, .8, .8, 1
        size: '116dp', '16sp'
        pos: root.pos
        halign: 'center'
